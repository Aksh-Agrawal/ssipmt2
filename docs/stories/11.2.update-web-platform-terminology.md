# Story 11.2: Update Web Platform Terminology from Chatbot to Agent - Brownfield Fix

## Status

Not Started

## User Story

**As a** citizen using the web-based Civic Voice Assistant,
**I want** the interface to accurately describe the system as an information agent,
**So that** I understand I'm querying live civic data, not chatting with a conversational AI bot.

## Story Context

### Existing System Integration

- **Integrates with:** Web platform chat interface (`apps/web-platform/app/components/ChatInterface.tsx`)
- **Technology:** Next.js 14+, React, TypeScript, Material-UI (MUI)
- **Follows pattern:** Existing React component patterns, MUI styling conventions
- **Touch points:**
  - ChatInterface component (message display, sender types)
  - Home page (app/page.tsx) - introductory text
  - ChatInterface test file (\_\_tests\_\_/ChatInterface.test.tsx)
  - Any other components referencing chat/bot terminology

### Current Issues

The web platform currently uses "chatbot" and "bot" terminology throughout the UI, which misrepresents the system's actual functionality:

1. **Message Interface Uses "bot" Type:**

   ```typescript
   interface Message {
     id: string;
     text: string;
     sender: "user" | "bot"; // Should be 'agent'
     timestamp: Date;
   }
   ```

2. **Placeholder Response References "bot":**

   ```typescript
   const botMessage: Message = {
     text: "Thank you for your message. This is a placeholder response.",
     sender: "bot", // Should be 'agent'
   };
   ```

3. **UI Labels May Reference "Chatbot" or "Bot":**
   - Component names, comments, or UI text using incorrect terminology

### Product Context

According to the PRD, this is a **Civic Information Agent** that:

- Queries a **Live Database** for civic information
- Accesses external APIs (e.g., traffic data)
- Retrieves real-time, factual information
- Does NOT engage in conversational AI behavior

The terminology must reflect **information retrieval** not **conversation**.

## Acceptance Criteria

### Functional Requirements

1. **Message interface uses 'agent' sender type** instead of 'bot'

   ```typescript
   sender: "user" | "agent";
   ```

2. **All variable names updated** from `botMessage`, `bot*` to `agentMessage`, `agent*`

3. **UI text and labels** accurately reflect agent behavior:
   - "Agent" not "Bot" or "Chatbot"
   - "Civic Information Agent" where appropriate
   - "Retrieving information..." not "Thinking..." or similar conversational AI language

### Integration Requirements

4. **Existing chat functionality** continues to work unchanged:

   - Message sending and receiving
   - Message display and styling
   - User input handling
   - Timestamp display

5. **Styling and visual design** remain consistent with Material-UI patterns:

   - Agent messages styled differently from user messages
   - No breaking changes to component props or interfaces

6. **Test suite updated** to reflect new terminology:
   - All test assertions updated
   - Test variable names updated
   - All tests passing

### Quality Requirements

7. **No references to "bot" or "chatbot"** in user-facing UI text

8. **Internal code comments updated** to use "agent" terminology

9. **Consistent terminology** across all web-platform files

10. **TypeScript types properly updated** with no type errors

## Tasks / Subtasks

### Task 1: Update ChatInterface Component Message Types

- [ ] **Subtask 1.1:** Update Message interface in `ChatInterface.tsx`

  ```typescript
  interface Message {
    id: string;
    text: string;
    sender: "user" | "agent"; // Changed from 'bot'
    timestamp: Date;
  }
  ```

- [ ] **Subtask 1.2:** Update all variable names from `botMessage` to `agentMessage`

- [ ] **Subtask 1.3:** Update placeholder response text to reflect agent behavior

  ```typescript
  text: "This is the Civic Information Agent. How can I help you find civic information today?";
  ```

- [ ] **Subtask 1.4:** Update conditional logic that checks `message.sender === 'bot'` to check for `'agent'`

- [ ] **Subtask 1.5:** Update any CSS class names from `bot*` to `agent*` if applicable

### Task 2: Update Page Text and Labels

- [ ] **Subtask 2.1:** Review `app/page.tsx` for any "chatbot" or "bot" references

- [ ] **Subtask 2.2:** Update page title or description if needed:

  ```tsx
  <h1>Civic Voice Assistant</h1>
  <p>Ask questions about civic information and services</p>
  ```

- [ ] **Subtask 2.3:** Ensure introductory text emphasizes information retrieval:
  ```tsx
  <p>Get real-time information about traffic, services, and civic updates</p>
  ```

### Task 3: Update Test Suite

- [ ] **Subtask 3.1:** Update test file `__tests__/ChatInterface.test.tsx`

- [ ] **Subtask 3.2:** Change all test expectations from `'bot'` to `'agent'`

  ```typescript
  expect(message.sender).toBe("agent"); // Changed from 'bot'
  ```

- [ ] **Subtask 3.3:** Update test variable names from `botMessage` to `agentMessage`

- [ ] **Subtask 3.4:** Update test descriptions to use "agent" terminology

- [ ] **Subtask 3.5:** Run tests to ensure all pass
  ```bash
  cd apps/web-platform
  npm run test
  ```

### Task 4: Search and Replace Across Web Platform

- [ ] **Subtask 4.1:** Search for all instances of "bot" (case-insensitive) in web-platform

  ```bash
  cd apps/web-platform
  grep -ri "bot" app/ --exclude-dir=node_modules
  ```

- [ ] **Subtask 4.2:** Search for all instances of "chatbot" in web-platform

  ```bash
  grep -ri "chatbot" app/ --exclude-dir=node_modules
  ```

- [ ] **Subtask 4.3:** Review each occurrence and update to "agent" where appropriate

- [ ] **Subtask 4.4:** Update code comments to use "agent" terminology

### Task 5: Verification and Testing

- [ ] **Subtask 5.1:** Build web-platform app successfully

  ```bash
  npm run build
  ```

- [ ] **Subtask 5.2:** Start development server and visually verify changes

  ```bash
  npm run dev
  ```

- [ ] **Subtask 5.3:** Test message sending/receiving functionality

- [ ] **Subtask 5.4:** Verify message styling remains correct for both user and agent messages

- [ ] **Subtask 5.5:** Check browser console for any errors

- [ ] **Subtask 5.6:** Run full test suite
  ```bash
  npm run test
  ```

## Technical Notes

### Integration Approach

This is a purely cosmetic/terminology change with no functional modifications. The changes involve:

1. Updating TypeScript type definitions
2. Renaming variables consistently
3. Updating UI text and labels
4. Updating test expectations

No API calls, no logic changes, no styling changes - only terminology alignment.

### Existing Pattern Reference

**Current Pattern:**

```typescript
// Message interface
interface Message {
  sender: "user" | "bot";
}

// Creating messages
const botMessage: Message = {
  sender: "bot",
  text: "Placeholder response",
};

// Conditional rendering
message.sender === "bot" ? styles.botMessage : styles.userMessage;
```

**Updated Pattern:**

```typescript
// Message interface
interface Message {
  sender: "user" | "agent";
}

// Creating messages
const agentMessage: Message = {
  sender: "agent",
  text: "Civic information response",
};

// Conditional rendering
message.sender === "agent" ? styles.agentMessage : styles.userMessage;
```

### Key Constraints

- **Must maintain all existing functionality** - Zero functional changes
- **Must preserve styling** - Agent messages should look the same as bot messages did
- **Must update tests** - All test assertions must reflect new terminology
- **Type safety** - TypeScript must compile without errors

### Material-UI Styling Considerations

If any MUI components reference "bot" in props or styling:

```typescript
// Before
sx={{ backgroundColor: message.sender === 'bot' ? 'grey.200' : 'primary.light' }}

// After
sx={{ backgroundColor: message.sender === 'agent' ? 'grey.200' : 'primary.light' }}
```

## Definition of Done

- [x] **Functional requirements met:**

  - [ ] Message interface uses `'user' | 'agent'` type
  - [ ] All variables renamed from `bot*` to `agent*`
  - [ ] UI text reflects agent behavior

- [x] **Integration requirements verified:**

  - [ ] Chat functionality works exactly as before
  - [ ] Message styling preserved
  - [ ] All tests updated and passing

- [x] **Quality requirements met:**

  - [ ] No "bot" or "chatbot" in user-facing UI
  - [ ] Code comments updated
  - [ ] Consistent terminology throughout
  - [ ] TypeScript compiles without errors

- [x] **Testing complete:**
  - [ ] Unit tests pass
  - [ ] Manual testing completed
  - [ ] Visual verification done
  - [ ] No console errors

## Risk and Compatibility Check

### Minimal Risk Assessment

**Primary Risk:** Breaking type compatibility or missing a reference to 'bot' causing runtime errors

**Mitigation:**

- Use TypeScript compiler to catch type mismatches
- Thorough search for all "bot" references before committing
- Run full test suite to catch any missed references
- Manual testing of message sending/receiving

**Rollback:**

- Simple git revert of changes to ChatInterface.tsx, page.tsx, and test files
- No database changes
- No API changes
- No dependency changes

### Compatibility Verification

- [x] **No breaking changes to existing APIs** - This is frontend-only
- [x] **Database changes:** None required
- [x] **UI functionality:** Preserved completely (only text changes)
- [x] **Performance impact:** None

## Dev Notes

### Search Strategy

Use these commands to find all references:

```bash
# Find "bot" (may have false positives like "robot", "bottom")
grep -rn "bot" apps/web-platform/app/ --include="*.tsx" --include="*.ts"

# Find "chatbot"
grep -rn "chatbot" apps/web-platform/ --include="*.tsx" --include="*.ts" --include="*.md"

# Find in test files
grep -rn "bot" apps/web-platform/__tests__/ --include="*.tsx" --include="*.ts"
```

### Files Expected to Change

1. `apps/web-platform/app/components/ChatInterface.tsx` - Primary changes
2. `apps/web-platform/__tests__/ChatInterface.test.tsx` - Test updates
3. `apps/web-platform/app/page.tsx` - Potential text updates

### Recommended UI Text

**Good Agent-Focused Text:**

- "Civic Information Agent"
- "Get real-time civic information"
- "Ask about traffic, services, and city updates"
- "Retrieving information..."
- "Agent is searching the database..."

**Avoid Chatbot-Style Text:**

- ❌ "I'm thinking..."
- ❌ "Chat with our bot"
- ❌ "AI conversation"
- ❌ "Let's chat"

### Testing Strategy

1. **TypeScript Compilation:** Ensures no type errors from terminology changes
2. **Unit Tests:** Verify message interface and rendering logic
3. **Visual Testing:** Manually verify UI displays correctly
4. **Functional Testing:** Send messages and verify they display with correct styling

### Estimated Effort

**Time Estimate:** 1-2 hours

- 20 min: Update ChatInterface component
- 20 min: Update tests
- 20 min: Search and verify no missed references
- 20 min: Testing and verification
- 20 min: Documentation review

## Related Files

### Files to Modify

- `apps/web-platform/app/components/ChatInterface.tsx` - **PRIMARY**
- `apps/web-platform/__tests__/ChatInterface.test.tsx` - **TESTS**
- `apps/web-platform/app/page.tsx` - **OPTIONAL** (if contains bot references)

### Files to Review (Unlikely to Need Changes)

- Other component files in `apps/web-platform/app/components/`
- Layout files
- Configuration files

## QA Checklist

Before marking this story as complete, verify:

- [ ] TypeScript compiles: `cd apps/web-platform && npx tsc --noEmit`
- [ ] No "bot" references in UI: Manually check running app
- [ ] Tests pass: `npm run test`
- [ ] Build succeeds: `npm run build`
- [ ] Messages display correctly with proper styling
- [ ] Both user and agent messages render properly
- [ ] No console errors when using the interface
- [ ] Searched codebase confirms no missed "bot" references

## Success Criteria

✅ **This story is successful when:**

1. All user-facing text uses "agent" instead of "bot" or "chatbot"
2. Message type definitions use `'user' | 'agent'`
3. All variables follow `agent*` naming convention
4. Chat interface functions exactly as before
5. All tests pass with updated terminology
6. TypeScript compilation succeeds
7. Product language aligns with PRD (Civic Information Agent)

---

**Story Created:** 2025-11-05  
**Epic:** Epic 11 - Codebase Health & Critical Bug Fixes  
**Priority:** Medium (UX Alignment)  
**Estimated Effort:** 1-2 hours  
**Dependencies:** None (can be done in parallel with Story 11.1)  
**Blocks:** None
