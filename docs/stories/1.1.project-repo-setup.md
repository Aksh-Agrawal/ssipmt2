# <!-- Powered by BMAD™ Core -->

# Story 1.1: Project & Repo Setup

## Status

ready-for-review

## Story

**As a** developer,
**I want** to initialize the monorepo with separate packages for the mobile app and backend services,
**so that** we have a clean, organized structure.

## Acceptance Criteria

1. A monorepo is created in Git with placeholder packages for the mobile app, reporting service, agent service, and admin service.
2. Basic linting and formatting configurations are in place.

## Tasks / Subtasks

- [x] Initialize a new Turborepo monorepo.
- [x] Create application stubs within the `apps` directory for `mobile`, `admin-web`, and `api`. (AC: #1)
- [x] Create shared package stubs within the `packages` directory for `shared-types`, `ui`, `config`, and `hooks`. (AC: #1)
- [x] Create backend service packages within `packages/services` for `reporting` and `agent`. (AC: #1)
- [x] Add base ESLint and Prettier configurations to the `packages/config` directory and apply them to the workspace. (AC: #2)
- [x] Configure the root `turbo.json` to define build, test, and lint pipelines. (AC: #2)

## Dev Notes

This foundational story establishes the monorepo structure as defined in the architecture document. All subsequent development will build upon this structure.

- **Monorepo Tool:** Turborepo
- **Package Manager:** uv
- **Repository Structure:**
  - `apps/mobile`: React Native mobile application.
  - `apps/admin-web`: Next.js admin dashboard.
  - `apps/api`: Hono backend API on Vercel.
  - `packages/shared-types`: Shared TypeScript types (e.g., Report, User).
  - `packages/ui`: Shared React components.
  - `packages/config`: Shared configurations (ESLint, TypeScript).
  - `packages/services/*`: Backend business logic for microservices.

### Testing

- **Testing Frameworks:** Jest will be used for all unit and integration testing. React Native Testing Library (RNTL) for mobile components and Supertest for backend API endpoints.
- **Test Location:** Tests must be co-located with the source code they are testing (e.g., `component.tsx` and `component.test.tsx` in the same folder).
- **Standards:** Follow the patterns outlined in the architecture document (Section 16.3).

## Change Log

| Date       | Version | Description                 | Author     |
| :--------- | :------ | :-------------------------- | :--------- |
| 2025-10-18 | 1.0     | Initial draft of the story. | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
- GitHub Copilot (GPT-4)

### Debug Log References
- None

### Completion Notes
- Turborepo monorepo structure successfully created in `my-turborepo/` directory
- All application stubs created: `apps/mobile`, `apps/admin-web`, `apps/api`
- All shared packages created: `packages/shared-types`, `packages/ui`, `packages/config`, `packages/hooks`
- Backend service packages created: `packages/services/reporting`, `packages/services/agent`
- ESLint and Prettier configurations added to root and all packages
- Turbo.json configured with build, test, lint, and check-types pipelines
- Sample test files created for service packages with Jest
- React version adjusted to 18.3.1 for React Native compatibility

### File List
#### Created Files
- `my-turborepo/apps/api/package.json`
- `my-turborepo/apps/api/src/index.ts`
- `my-turborepo/apps/api/tsconfig.json`
- `my-turborepo/apps/api/eslint.config.js`
- `my-turborepo/apps/api/README.md`
- `my-turborepo/apps/mobile/package.json`
- `my-turborepo/apps/mobile/src/index.ts`
- `my-turborepo/apps/mobile/tsconfig.json`
- `my-turborepo/apps/mobile/babel.config.js`
- `my-turborepo/apps/mobile/eslint.config.js`
- `my-turborepo/apps/mobile/README.md`
- `my-turborepo/packages/shared-types/package.json`
- `my-turborepo/packages/shared-types/src/index.ts`
- `my-turborepo/packages/shared-types/tsconfig.json`
- `my-turborepo/packages/shared-types/eslint.config.js`
- `my-turborepo/packages/config/package.json`
- `my-turborepo/packages/config/src/index.ts`
- `my-turborepo/packages/config/tsconfig.json`
- `my-turborepo/packages/config/eslint.config.js`
- `my-turborepo/packages/hooks/package.json`
- `my-turborepo/packages/hooks/src/index.ts`
- `my-turborepo/packages/hooks/src/useDebounce.ts`
- `my-turborepo/packages/hooks/tsconfig.json`
- `my-turborepo/packages/hooks/eslint.config.js`
- `my-turborepo/packages/services/reporting/package.json`
- `my-turborepo/packages/services/reporting/src/index.ts`
- `my-turborepo/packages/services/reporting/src/index.test.ts`
- `my-turborepo/packages/services/reporting/tsconfig.json`
- `my-turborepo/packages/services/reporting/eslint.config.js`
- `my-turborepo/packages/services/reporting/jest.config.js`
- `my-turborepo/packages/services/agent/package.json`
- `my-turborepo/packages/services/agent/src/index.ts`
- `my-turborepo/packages/services/agent/src/index.test.ts`
- `my-turborepo/packages/services/agent/tsconfig.json`
- `my-turborepo/packages/services/agent/eslint.config.js`
- `my-turborepo/packages/services/agent/jest.config.js`
- `my-turborepo/.prettierrc`
- `my-turborepo/.prettierignore`

#### Modified Files
- `my-turborepo/apps/admin-web/package.json` (renamed from web)
- `my-turborepo/package.json` (added test script, updated workspaces)
- `my-turborepo/turbo.json` (added test pipeline configuration)

## QA Results

### Review Date: 2025-10-31

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

The monorepo structure has been successfully established with all required components. The implementation demonstrates solid architectural foundations with proper separation of concerns across applications and packages. TypeScript configuration is consistent throughout the workspace with appropriate module resolution settings.

### Refactoring Performed

Several critical configuration issues were identified and resolved during the review:

- **File**: `packages/hooks/src/index.ts`
  - **Change**: Added `.js` extension to relative import
  - **Why**: NodeNext module resolution requires explicit file extensions for ES modules
  - **How**: Ensures TypeScript compilation compatibility with the chosen module system

- **File**: `packages/services/*/src/index.test.ts`
  - **Change**: Updated import paths to include `.js` extensions
  - **Why**: Consistency with NodeNext module resolution requirements
  - **How**: Enables proper test execution in the ES modules environment

- **File**: `packages/eslint-config/base.js`
  - **Change**: Added default export alongside named export
  - **Why**: Package consumers were attempting to import default but only named export existed
  - **How**: Provides both import patterns for maximum compatibility

- **File**: `packages/*/eslint.config.js`
  - **Change**: Updated ESLint config imports to use correct package exports
  - **Why**: Package exports were not matching the import patterns used
  - **How**: Ensures ESLint configuration loads properly across all packages

### Compliance Check

- **Coding Standards**: ✓ TypeScript usage throughout, proper naming conventions
- **Project Structure**: ✓ Clean monorepo organization with apps/, packages/, and services/
- **Testing Strategy**: ✓ Jest configured with co-located tests, adequate coverage setup
- **All ACs Met**: ✓ All acceptance criteria fully implemented

### Improvements Checklist

- [x] Fixed TypeScript module resolution issues across all packages
- [x] Corrected ESLint configuration exports and imports
- [x] Ensured Jest configurations support TypeScript properly
- [x] Verified monorepo workspace configuration includes all packages
- [ ] Consider adding pre-commit hooks for quality enforcement
- [ ] Add GitHub Actions workflow for CI/CD pipeline
- [ ] Consider adding Husky for git hooks automation

### Security Review

No security concerns identified. Configuration files properly exclude sensitive patterns (.env files in .gitignore, no hardcoded secrets).

### Performance Considerations

Turbo.json optimally configured with proper caching strategies and dependency graphs. Build outputs correctly specified to enable effective caching.

### Files Modified During Review

- `packages/hooks/src/index.ts` - Fixed import extension
- `packages/services/reporting/src/index.test.ts` - Fixed import extension  
- `packages/services/agent/src/index.test.ts` - Fixed import extension
- `packages/eslint-config/base.js` - Added default export
- Multiple `eslint.config.js` files - Fixed import paths

### Gate Status

Gate: PASS → docs/qa/gates/1.1-project-repo-setup.yml

### Recommended Status

✓ Ready for Done - All technical issues resolved, structure meets architectural requirements
