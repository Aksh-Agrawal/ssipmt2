# <!-- Powered by BMADâ„¢ Core -->
# Story 2.4: Report Detail View

## Status
Draft

## Story
**As an** admin,
**I want** to click on a report to see its full details, including the photo and map location,
**so that** I can investigate the issue.

## Acceptance Criteria
1. Clicking on a report summary in the main dashboard list navigates the user to a unique URL for that report.
2. A protected API endpoint is created to fetch a single report by its ID.
3. The detail view displays all information for the report: full description, status, priority, and the attached photo.
4. The detail view displays an interactive map with a pin at the report's geo-tagged location.

## Tasks / Subtasks

### Backend
- [ ] Create a new dynamic, protected API endpoint: `GET /api/v1/admin/reports/[id]`. (AC: #2)
- [ ] Implement the repository function (`reportRepository.findById`) to fetch one report from the **Complaints DB** by its ID. (AC: #2)
- [ ] If no report is found for the ID, the endpoint should return a `404 Not Found` status. (AC: #2)

### Frontend
- [ ] Create a new dynamic route in the Next.js admin app at `app/dashboard/reports/[id]/page.tsx`. (AC: #1)
- [ ] Wrap the items in the `ReportListItem` component with a Next.js `<Link>` to navigate to the corresponding detail page. (AC: #1)
- [ ] On the detail page, fetch the data for the single report from the new API endpoint using the ID from the URL. (AC: #3)
- [ ] Display all the fetched report details (description, status, etc.). (AC: #3)
- [ ] Render the image using the `photoUrl` from the report data. (AC: #3)
- [ ] Research and integrate a map component library (e.g., `@vis.gl/react-google-maps`) to display the location. (AC: #4)

## Dev Notes
This story introduces dynamic routing and the display of a single, detailed record. It also requires integrating a new third-party dependency for the map view.

- **Dynamic Routing:** Use the standard Next.js App Router conventions for dynamic segments.
- **Map Component:** The architecture mentions Google Maps as a dependency for other features, so using the official `@vis.gl/react-google-maps` library is recommended for consistency. The API key for Google Maps will need to be configured for the admin web app.
- **Data Fetching:** Continue using the data-fetching library introduced in the previous story (`React Query` or `SWR`) to handle the request for the single report.
- **API Security:** The new `GET /api/v1/admin/reports/[id]` endpoint must be protected by the same authentication middleware as the list endpoint.

### Testing
- **Backend Integration Test:** Write a test for the `GET /api/v1/admin/reports/[id]` endpoint. Test that a valid ID returns the correct report and a `200` status. Test that an invalid ID returns a `404` status. Test that an unauthenticated request returns a `401` status.
- **Frontend Integration Test:** Write a test for the report detail page. Mock the API endpoint for a single report. Verify that the component fetches the data and correctly renders all the details, including the image. A mock version of the map component should be used to verify it receives the correct location props.

## Change Log
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-10-18 | 1.0 | Initial draft of the story. | Sarah (PO) |
