# <!-- Powered by BMADâ„¢ Core -->
# Story 1.5: Photo Attachment

## Status
Draft

## Story
**As a** citizen,
**I want** to attach a geo-tagged photo to my report,
**so that** I can provide visual proof of the issue.

## Acceptance Criteria
1. The user can attach a photo to their report by either taking a new one with the camera or selecting one from their device's gallery.
2. After a photo is selected, a thumbnail of it is displayed on the report submission screen.
3. The application captures the device's current GPS coordinates (latitude and longitude) when the photo is attached.
4. The user must be prompted for camera and location permissions if not already granted.

## Tasks / Subtasks
- [ ] Add an "Attach Photo" button to the `ReportSubmissionScreen.tsx`. (AC: #1)
- [ ] Research and integrate a suitable image picker library (e.g., `react-native-image-picker`). (AC: #1)
- [ ] Research and integrate a suitable geolocation library (e.g., `react-native-geolocation-service`). (AC: #3)
- [ ] Implement logic to request camera, photo gallery, and location permissions. (AC: #4)
- [ ] Add an `Image` component to the screen to display the selected photo's thumbnail. (AC: #2)
- [ ] Create state variables to hold the selected image URI and the captured location data. (AC: #2, #3)
- [ ] On button press, launch the image picker, allowing the user to choose between camera or gallery. (AC: #1)
- [ ] Upon successful image selection, update the state with the image URI and fetch the current geolocation to store in state. (AC: #2, #3)

## Dev Notes
This story adds the crucial data integrity feature of verified, geo-tagged proof. The process should feel seamless to the user.

- **Image Picker Library:** `react-native-image-picker` is a strong candidate as it supports both camera and library access and is well-maintained.
- **Geolocation Library:** `react-native-geolocation-service` is recommended over the built-in React Native one for better accuracy and maintenance.
- **Permissions:** Ensure that `Info.plist` (iOS) and `AndroidManifest.xml` (Android) are updated with clear descriptions for why the app needs camera, photo library, and location permissions. This is critical for user trust and App Store approval.
- **Data Handling:** This story is only concerned with capturing the image URI and location data in the frontend state. The actual file upload and data submission will be handled in the next story (1.6).

### Testing
- **Unit Test:** The `ReportSubmissionScreen` test should be updated to assert that the "Attach Photo" button is rendered.
- **Integration Test:** Mock both the image picker and geolocation libraries. Write a test to simulate a press on the "Attach Photo" button. Verify that the mocked library's launch function is called. Simulate a successful response from both mocks and verify that the `Image` component displays the correct thumbnail and that the location data is correctly stored in the component's state.

## Change Log
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-10-18 | 1.0 | Initial draft of the story. | Sarah (PO) |
