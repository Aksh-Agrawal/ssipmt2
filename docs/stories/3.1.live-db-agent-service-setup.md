# <!-- Powered by BMADâ„¢ Core -->
# Story 3.1: Live DB and Agent Service Setup

## Status
Draft

## Story
**As a** developer,
**I want** to set up the **Live DB** and the initial `agent-service`,
**so that** we have the foundation for the information agent.

## Acceptance Criteria
1. A new Redis database (Upstash) is provisioned to serve as the **Live DB**.
2. The `agent-service` package is initialized with a Redis client configured to connect to the Live DB.
3. The Live DB connection credentials are securely managed via environment variables.
4. A basic health-check function exists within the service to verify the database connection.

## Tasks / Subtasks
- [ ] Provision a new Redis database via the Upstash console. (AC: #1)
- [ ] Add the new `REDIS_URL` and `REDIS_TOKEN` to the project's `.env` configuration files. (AC: #3)
- [ ] In the `packages/services/agent` directory, add the `@upstash/redis` dependency. (AC: #2)
- [ ] Create a new file (e.g., `redisClient.ts`) to initialize and export a singleton Redis client instance, configured using the environment variables. (AC: #2)
- [ ] Create a `healthCheck.ts` file in the service that exports a function to perform a `ping` command to the Live DB and confirm a successful connection. (AC: #4)

## Dev Notes
This story establishes the second database for the project, which is a critical piece of the dual-database architecture. This database is optimized for the agent's fast-read requirements.

- **Database:** The architecture specifies Redis (specifically Upstash) for the Live DB due to its speed and integration with serverless environments (`docs/architecture/3-tech-stack.md`).
- **Service Location:** All logic for this story should be contained within the `packages/services/agent` directory. No public-facing API endpoints are created in this story.
- **Configuration:** All credentials must be loaded from environment variables and should not be hard-coded.

### Testing
- **Integration Test:** Write an integration test for the `healthCheck` function. This test will require the Redis environment variables to be set. It should call the function and assert that it returns a success status, confirming the connection logic is correct. Mocking the Redis client is an alternative if a live test database is not available in the CI environment.

## Change Log
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-10-18 | 1.0 | Initial draft of the story. | Sarah (PO) |
